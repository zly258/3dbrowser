!function(){"use strict";self.onmessage=function(t){const{buffer:n,version:e,originalUuid:o,bimIdTable:s}=t.data;try{let t;t=e>=8?function(t,n,e){const o=new DataView(t);let s=0;const i=o.getUint32(s,!0);s+=4;const r=[];for(let l=0;l<i;l++){const n=o.getUint32(s,!0);s+=4;const e=o.getUint32(s,!0);s+=4;const i=new Float32Array(t.slice(s,s+12*n));s+=12*n;const c=new Float32Array(t.slice(s,s+12*n));s+=12*n;const a={position:i,normal:c,index:null};if(e>0){const n=new Uint32Array(t.slice(s,s+4*e));s+=4*e,a.index=n}r.push(a)}const c=o.getUint32(s,!0);s+=4;const a=[];for(let l=0;l<c;l++){const t=o.getUint32(s,!0);s+=4,o.getUint32(s,!0),s+=4;const n=o.getUint32(s,!0);s+=4;const i=new Float32Array(16);for(let e=0;e<16;e++)i[e]=o.getFloat32(s,!0),s+=4;const r=o.getUint32(s,!0);s+=4,a.push({bimId:e[t]??String(t),color:n,matrix:i,geoIdx:r})}return{geometries:r,instances:a,originalUuid:n}}(n,o,s||[]):function(t,n){const e=new DataView(t);let o=0;const s=e.getUint32(o,!0);o+=4;const i=[];for(let a=0;a<s;a++){const n=e.getUint32(o,!0);o+=4;const s=e.getUint32(o,!0);o+=4;const r=new Float32Array(t.slice(o,o+12*n));o+=12*n;const c=new Float32Array(t.slice(o,o+12*n));o+=12*n;const a={position:r,normal:c,index:null};if(s>0){const n=new Uint32Array(t.slice(o,o+4*s));o+=4*s,a.index=n}i.push(a)}const r=e.getUint32(o,!0);o+=4;const c=[];for(let a=0;a<r;a++){const t=e.getUint32(o,!0);o+=4,e.getUint32(o,!0),o+=4;const n=e.getUint32(o,!0);o+=4;const s=new Float32Array(16);for(let r=0;r<16;r++)s[r]=e.getFloat32(o,!0),o+=4;const i=e.getUint32(o,!0);o+=4,c.push({bimId:String(t),color:n,matrix:s,geoIdx:i})}return{geometries:i,instances:c,originalUuid:n}}(n,o);const i=[];t.geometries.forEach(t=>{t.position&&i.push(t.position.buffer),t.normal&&i.push(t.normal.buffer),t.index&&i.push(t.index.buffer)}),t.instances.forEach(t=>{t.matrix&&i.push(t.matrix.buffer)}),self.postMessage({type:"success",result:t},i)}catch(i){self.postMessage({type:"error",error:i.message||String(i)})}}}();
